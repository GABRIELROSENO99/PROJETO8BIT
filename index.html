<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Gui The Kid - Vencendo a CLT</title>

    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            overflow: hidden; display: flex; justify-content: center; align-items: center;
            min-height: 100vh; background: #1a0d00; font-family: 'Courier New', monospace;
            touch-action: none; user-select: none;
        }
        canvas {
            display: block; max-width: 100%; max-height: 100%;
            image-rendering: pixelated; image-rendering: -moz-crisp-edges; image-rendering: crisp-edges;
            box-shadow: 0 0 30px rgba(255,100,0,0.6); border: 6px solid #ff6600; border-radius: 16px;
        }
        #loading {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #ffaa00; font-size: 2.2rem; font-weight: bold; text-align: center;
            text-shadow: 0 0 20px #ff6600; animation: glow 1.2s infinite; pointer-events: none; z-index: 200;
        }
        @keyframes glow {
            0%,100% { opacity: 0.8; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.08); }
        }
        @media (max-width: 600px) {
            canvas { width: 100vw !important; height: 100vh !important; border-radius: 0; border: none; }
            #loading { font-size: 1.6rem; }
        }
    </style>
</head>
<body>
    <div id="loading">CARREGANDO 2D...</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
    <script>
        // ===================================
        // GUI THE KID - 2D SIDE-SCROLLER PERFEITO
        // Pixel Art 100% fiel à imagem!
        // ===================================

        let gui, chaoY, obstaculos = [], itens = [], nuvens = [];
        let velocidadeJogo = 4, gameState = 'running', vida = 100, dinheiro = 0, fase = 1;
        let shake = 0, score = 0, canJump = true;

        const C = {
            skyTop: [200,120,80], skyBot: [50,30,60],
            ground: [79,59,44], line: [120],
            shirt: [200,220,255], collar: [100,150,220],
            pants: [100,140,220], shoe: [40],
            hair: [90,60,30], skin: [255,200,150],
            cone: [255,140,0], trash: [90,90,90], box: [120,60,40], homeless: [60,50,40],
            money: [255,230,100], controller: [50,180,255]
        };

        function setup() {
            createCanvas(min(1000, windowWidth), min(600, windowHeight));
            pixelDensity(1);
            textFont('monospace');
            textAlign(CENTER, CENTER);
            textSize(12);
            chaoY = height - 100;
            gui = new Gui();
            for(let i = 0; i < 6; i++) nuvens.push(new Nuvem());
        }

        function draw() {
            // Céu 2D gradiente
            for(let y = 0; y < chaoY; y++) {
                let t = map(y, 0, chaoY, 0, 1);
                let col = lerpColor(color(...C.skyTop), color(...C.skyBot), t);
                stroke(col); line(0, y, width, y);
            }

            // Nuvens
            for(let n of nuvens) n.draw();

            if(gameState === 'running') {
                updateGame();
            } else if(gameState === 'gameover') {
                drawGameOver();
            } else if(gameState === 'vitoria') {
                drawVitoria();
            }

            drawHUD();
        }

        function updateGame() {
            score++;
            shake *= 0.92;

            // Spawn
            if(frameCount % 100 === 0) obstaculos.push(new Obstaculo());
            if(frameCount % 160 === 0) itens.push(new Item());

            // Nuvens
            for(let n of nuvens) n.update();

            // Obstáculos
            for(let i = obstaculos.length - 1; i >= 0; i--) {
                let o = obstaculos[i];
                o.update();
                o.draw();
                if(gui.colide(o)) {
                    vida -= 25;
                    obstaculos.splice(i, 1);
                    shake = 12;
                    if(vida <= 0) { gameState = 'gameover'; noLoop(); }
                }
                if(o.x < -60) obstaculos.splice(i, 1);
            }

            // Itens
            for(let i = itens.length - 1; i >= 0; i--) {
                let it = itens[i];
                it.update();
                it.draw();
                if(gui.pega(it)) {
                    if(it.tipo === 'dinheiro') dinheiro += 10;
                    else vida = min(100, vida + 35);
                    itens.splice(i, 1);
                }
                if(it.x < -40) itens.splice(i, 1);
            }

            // Fases
            if(dinheiro >= 35 && fase === 1) { fase = 2; velocidadeJogo = 5; }
            if(dinheiro >= 80 && fase === 2) { fase = 3; velocidadeJogo = 5.5; }
            if(dinheiro >= 130 && fase === 3) { gameState = 'vitoria'; noLoop(); }

            gui.update();
            gui.draw();
            drawChao();
        }

        function drawChao() {
            fill(...C.ground);
            noStroke();
            rect(0, chaoY, width, height - chaoY);
            stroke(...C.line);
            strokeWeight(3);
            for(let x = 0; x < width; x += 60) line(x, chaoY, x + 30, chaoY);
            noStroke();
        }

        // ========== GUI 2D PIXEL ART ==========
        class Gui {
            constructor() {
                this.x = 80;
                this.y = chaoY - 42;
                this.vy = 0;
                this.frame = 0;
                this.w = 28;
                this.h = 42;
            }
            update() {
                this.frame += 0.25;
                this.vy += 0.9;
                this.y += this.vy;
                if(this.y >= chaoY - 42) {
                    this.y = chaoY - 42;
                    this.vy = 0;
                    canJump = true;
                }
            }
            colide(o) {
                return this.x < o.x + o.w && this.x + this.w > o.x &&
                       this.y < o.y + o.h && this.y + this.h > o.y;
            }
            pega(it) {
                return dist(this.x + 14, this.y + 21, it.x, it.y) < 30;
            }
            draw() {
                push();
                translate(this.x, this.y + shake);

                // Pernas
                let leg = sin(this.frame) * 3;
                fill(...C.pants);
                rect(6, 26, 5, 14, 1); rect(6 + leg, 34, 5, 6, 1);
                rect(17, 26, 5, 14, 1); rect(17 - leg, 34, 5, 6, 1);

                // Sapatos
                fill(...C.shoe);
                rect(6, 38, 6, 3); rect(17, 38, 6, 3);

                // Calça
                fill(...C.pants);
                rect(6, 22, 16, 6, 2);

                // Camisa
                fill(...C.shirt);
                rect(4, 10, 20, 14, 2);
                fill(...C.collar);
                rect(7, 12, 2, 3); rect(19, 12, 2, 3);

                // Cinto
                fill(60,40,20);
                rect(6, 22, 16, 2);

                // Cabeça
                fill(...C.skin);
                ellipse(14, 6, 14, 14);

                // Cabelo cacheado
                fill(...C.hair);
                ellipse(10, 2, 8, 6); ellipse(14, 0, 10, 7); ellipse(18, 2, 8, 6);
                fill(70,40,10);
                ellipse(12, 1, 4, 3); ellipse(16, 1, 4, 3);

                // Olhos
                fill(0);
                ellipse(11, 5, 2, 2); ellipse(17, 5, 2, 2);
                fill(255);
                ellipse(11.2, 4.8, 1, 1); ellipse(17.2, 4.8, 1, 1);

                // Boca
                stroke(200,150,120);
                strokeWeight(1);
                noFill();
                arc(14, 9, 6, 4, 0, PI);
                noStroke();

                // Braços
                fill(...C.shirt);
                rect(0, 12, 5, 8, 1); rect(23, 12, 5, 8, 1);

                // Mãos
                fill(...C.skin);
                ellipse(2, 15, 4, 4);
                ellipse(27, 15, 4, 4);

                pop();
            }
        }

        // ========== OBSTÁCULOS ==========
        class Obstaculo {
            constructor() {
                this.x = width + 100;
                this.y = chaoY;
                this.tipo = floor(random(4));
                this.w = this.tipo === 0 ? 12 : this.tipo === 1 ? 16 : this.tipo === 2 ? 24 : 20;
                this.h = this.tipo === 0 ? 20 : this.tipo === 1 ? 22 : this.tipo === 2 ? 18 : 32;
            }
            update() { this.x -= velocidadeJogo; }
            draw() {
                push();
                translate(this.x, this.y + shake);
                if(this.tipo === 0) { // Cone
                    fill(...C.cone);
                    triangle(2, 20, 10, 2, 18, 20);
                    fill(255,50,0);
                    triangle(4, 15, 10, 8, 16, 15);
                } else if(this.tipo === 1) { // Lixeira
                    fill(...C.trash);
                    rect(2, 8, 12, 14, 2); rect(1, 6, 14, 4, 1);
                    fill(255);
                    ellipse(7, 12, 3, 3);
                } else if(this.tipo === 2) { // Caixa
                    fill(...C.box);
                    rect(0, 0, 24, 18, 2);
                    fill(200,150,100);
                    rect(4, 4, 16, 10, 1);
                    fill(255,0,0);
                    textSize(6);
                    text("CLT", 12, 9);
                } else { // Morador
                    fill(...C.homeless);
                    ellipse(10, 8, 16, 20);
                    fill(...C.skin);
                    ellipse(10, 4, 10, 10);
                    fill(0);
                    ellipse(7, 3, 2, 2); ellipse(13, 3, 2, 2);
                    fill(255,200,150);
                    arc(10, 7, 6, 4, PI, TWO_PI);
                }
                pop();
            }
        }

        // ========== ITENS ==========
        class Item {
            constructor() {
                this.x = width + random(200, 400);
                this.y = chaoY - random(60, 120);
                this.tipo = random() > 0.5 ? 'dinheiro' : 'controle';
                this.bounce = 0;
            }
            update() {
                this.x -= velocidadeJogo * 0.7;
                this.bounce = sin(frameCount * 0.1) * 2;
            }
            draw() {
                push();
                translate(this.x, this.y + this.bounce + shake);
                if(this.tipo === 'dinheiro') {
                    fill(...C.money);
                    rect(2, 2, 12, 12, 2);
                    fill(255,215,0);
                    textSize(10);
                    text("R$", 8, 11);
                } else {
                    fill(...C.controller);
                    rect(1, 4, 14, 8, 2);
                    fill(255);
                    ellipse(5, 8, 3, 3); ellipse(11, 8, 3, 3);
                }
                pop();
            }
        }

        // ========== NUVENS ==========
        class Nuvem {
            constructor() {
                this.x = random(width);
                this.y = random(50, 200);
                this.size = random(40, 80);
                this.speed = random(0.2, 0.5);
            }
            update() {
                this.x -= this.speed;
                if(this.x < -this.size) this.x = width + this.size;
            }
            draw() {
                fill(255,255,255,180);
                noStroke();
                ellipse(this.x, this.y, this.size, this.size * 0.6);
                ellipse(this.x + this.size*0.3, this.y, this.size*0.8, this.size*0.5);
                ellipse(this.x - this.size*0.3, this.y, this.size*0.8, this.size*0.5);
            }
        }

        // ========== HUD ==========
        function drawHUD() {
            fill(0,0,0,200);
            rect(20, 20, 280, 80, 12);
            fill(255,50,50);
            rect(40, 30, vida * 1.6, 20, 8);
            fill(255);
            textSize(16);
            text(`VIDA ${vida}`, 140, 42);
            fill(255,215,0);
            text(`R$ ${dinheiro}`, 140, 68);
            fill(0,255,255);
            textSize(20);
            text(['MorumBI','ÔNIBUS','METRÔ','JABAQUARA!'][fase-1], 250, 45);
        }

        function drawGameOver() {
            fill(0,0,0,240);
            rect(0,0,width,height);
            fill(255,100,100);
            textSize(60);
            text("GAME OVER", width/2, height/2 - 30);
            fill(255);
            textSize(24);
            text("ESPAÇO ou TOQUE", width/2, height/2 + 30);
        }

        function drawVitoria() {
            fill(100,255,100,240);
            rect(0,0,width,height);
            fill(255,215,0);
            textSize(50);
            text("LEVEL COMPLETE!", width/2, height/2 - 40);
            fill(255);
            textSize(28);
            text(`JABAQUARA! R$ ${dinheiro}`, width/2, height/2 + 20);
            text("Toque para jogar de novo", width/2, height/2 + 50);
        }

        function keyPressed() {
            if((key === ' ' || key === 'ArrowUp') && gameState === 'running' && canJump) {
                gui.vy = -22;
                canJump = false;
            } else if(gameState !== 'running') restart();
        }

        function touchStarted() {
            if(gameState === 'running' && canJump) {
                gui.vy = -22;
                canJump = false;
            } else if(gameState !== 'running') restart();
            return false;
        }

        function restart() {
            gameState = 'running'; vida = 100; dinheiro = 0; fase = 1;
            velocidadeJogo = 4; obstaculos = []; itens = []; canJump = true; shake = 0;
            gui = new Gui();
            loop();
        }

        function windowResized() {
            resizeCanvas(min(1000, windowWidth), min(600, windowHeight));
            chaoY = height - 100;
            gui.y = chaoY - 42;
        }

        // Loading
        setTimeout(() => {
            const l = document.getElementById('loading');
            l.style.transition = 'opacity 0.5s';
            l.style.opacity = '0';
            setTimeout(() => l.style.display = 'none', 500);
        }, 2000);
    </script>
</body>
</html>
